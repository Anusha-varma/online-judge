{% extends 'base.html' %}

{% block title %}{{ contest.name }}{% endblock %}
<style>
  #countdown {
    font-weight: bold;
    font-size: 1.2rem;
  }
</style>

{% block content %}
<div class="max-w-4xl mx-auto p-6">
 <div class="flex justify-between"> <h1 class="text-3xl font-bold text-white mb-6">{{ contest.name }}</h1>
<div class="text-lg text-yellow-300 mb-6">
  ‚è≥ Time remaining: <span id="countdown" class="font-mono text-white"></span>
</div></div>

  <p class="text-gray-300">{{ contest.description }}</p>
  <p class="text-sm text-gray-400">Start: {{ contest.start_time }}</p>
  <p class="text-sm text-gray-400">End: {{ contest.end_time }}</p>

  <h2 class="text-xl font-semibold text-indigo-400 mt-6">Problems:</h2>
  <ul class="mt-4 space-y-3">
    {% for problem in problems %}
      <li class="bg-gray-700 p-4 rounded shadow text-white">
        <a href="{% url 'problem_detail' problem.id %}" class="hover:underline">{{ problem.title }}</a>
      </li>
    {% empty %}
      <li class="text-gray-400">No problems assigned to this contest.</li>
    {% endfor %}
  </ul>
</div>
<script>
  const endTime = new Date("{{ end_time }}").getTime();

  function updateCountdown() {
    const now = new Date().getTime();
    const distance = endTime - now;

    if (distance < 0) {
      document.getElementById("countdown").innerText = "Contest ended!";
      return;
    }

    const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((distance % (1000 * 60)) / 1000);

    document.getElementById("countdown").innerText = 
      `${hours}h ${minutes}m ${seconds}s`;
  }

  updateCountdown();
  setInterval(updateCountdown, 1000);
</script>

{% endblock %}
